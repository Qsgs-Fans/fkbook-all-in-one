添加一个技能
==============

都2024年了，再端上五血白板多少有点欺负自己了……
给这位五血将加什么技能呢……要不\ **〖无双〗**\ ？正好标包有，也不用麻烦我们写了。

在vscode切到刚才的xuexi.lua，在引入孙悟空的代码下面加个代码：\ ``sunwukong:addSkill("wushuang")``

.. code-block:: lua
  :emphasize-lines: 2
  :linenos:

  local sunwukong = General:new(extension, "st__sunwukong", "god", 5)
  sunwukong:addSkill("wushuang")

这样孙悟空就可以无双了……吗？

.. note::

	像new()、addSkill()这样右侧带有小括号的代码被称之为函数，
	函数是调用其他部分代码的依据、是多个部分互相沟通的渠道，
	可以这么说，函数是新月杀扩展的根基。

	一个扩展包会有单独存在的函数（如一些扩展包自己的局部变量\ ``local function XXX()``\ ），\
	也有依附于对象存在的函数（如上文的\ ``General:new()``\ ）。

	由此，调用一个函数也有所讲究，这里以一个常用函数\ ``Player:getMark()``\ 为例，该函数的原型如下：

	.. code-block:: lua

		--- 获取角色对应Mark的数量。
		---@param mark string @ 标记
		---@return any
		function Player:getMark(mark)

	假设\ ``player``\ 是一个\ ``Player``\ ，我们可以使用\ ``player:getMark("XXX")``\ 调用这个函数，
	当然，我们也可以用\ ``Player.getMark(player, "XXX")``\ 调用这个函数，二者返回的结果是一样的。

	可见用冒号\ ``:``\ 调用函数的话，相当于将左边的对象传入了第一个参数，就不用在括号内写第一个参数的值了。
	
	然而，另一个常用函数的\ ``table:map()``\ （虽然是table的函数，但实际上这不是lua原生的函数）的原型如下：

	.. code-block:: lua

		---@param func fun(element, index, array): any
		function table:map(func)

	但是实际上大家调用函数时，使用的不是\ ``tableA:map(...)``\ ，而是\ ``table.map(tableA, ...)``\ 。
	关于什么时候可以/不可以用冒号\ ``:``\ 调用函数，这涉及到Lua库对一些自定义类型的特殊处理，这里不再赘述。

	总而言之，日常编程时，除了调用table的函数需要用英文句号\ ``.``\ 以外，
	其他地方用\ ``:``\ 调用函数会将自身传入函数的第一个参数（如果函数自身就是用冒号声明的话就是单独的一个\ ``self``\ 变量（这也是这个函数的真正的“第一个参数”））。

要注意的是，\ **〖无双〗**\ 是吕布这个技能的中文名，而现如今，技能重名更是家常便饭，你看界吕布也有个\ **〖无双〗**\ 嘛~
所以我们给孙悟空安上\ **〖无双〗**\ 的时候，要找的是这个技能的“名字”，或者说——\ `本名`\ 。
最简单的方法就是在标包的扩展包\ ``standard``\ 里全局搜索“无双”，找到翻译部分的代码，
因为翻译表是一一对应的，所以会有个\ ``["wushuang"] == "无双"``\ ，这样我们就知道标吕布的\ **〖无双〗**\ 名字叫\ ``"wushuang"``\ 了。

[图片]众所周知，中文名≠技能本名

至于\ ``General:addSkill()``\ ，这个是真正赋予武将技能的函数，有了它，孙悟空才能拥有这个技能。
该函数的原型如下：

.. code-block:: lua

	--- 为武将增加技能，需要注意增加其他武将技能时的处理方式。
	---@param skill Skill @ （单个）武将技能
	function General:addSkill(skill)

显然，这个函数可以接受一个技能\ ``Skill``\ ，也就是一个属于技能对象\ ``Skill``\ 的变量；
但同时，这个函数也可以接受字符串，此时就可以添加别人的技能了~

鉴于孙悟空在前文已经定义为学习包里的一个崭新的武将——\ ``General``\ 了，
他像其他所有的\ ``General``\ 一样，也有\ ``addSkill()``\ 方法。
这个\ ``addSkill()``\ 就是\ ``General``\ 这个类的\ **成员函数**\ ，
只要一个变量是\ ``General``\ ，它就能使用这个类的任何成员函数。

添加完技能之后，就可以重启游戏，看一下新鲜出炉的崭新孙悟空了：

[图片]谁能挡我！

这回总可以好好单挑了，五血无双还没负面技，总该……

[图片]你又是谁？
